!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Router=e()}(this,function(){"use strict";function t(t,e){return-1===t.href.indexOf(e)}function e(t){return t.origin.indexOf("mailto")>-1}function n(t,e){for(var n,r=[],a=0,s=0,u="",h=e&&e.delimiter||l,c=e&&e.delimiters||p,d=!1;null!==(n=f.exec(t));){var m=n[0],g=n[1],v=n.index;if(u+=t.slice(s,v),s=v+m.length,g)u+=g[1],d=!0;else{var _="",x=t[s],R=n[2],k=n[3],w=n[4],b=n[5];if(!d&&u.length){var y=u.length-1;c.indexOf(u[y])>-1&&(_=u[y],u=u.slice(0,y))}u&&(r.push(u),u="",d=!1);var E=""!==_&&void 0!==x&&x!==_,P="+"===b||"*"===b,A="?"===b||"*"===b,C=_||h,L=k||w;r.push({name:R||a++,prefix:_,delimiter:C,optional:A,repeat:P,partial:E,pattern:L?o(L):"[^"+i(C)+"]+?"})}}return(u||s<t.length)&&r.push(u+t.substr(s)),r}function i(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function o(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function r(t){return t&&t.sensitive?"":"i"}function a(t,e){if(!e)return t;var n=t.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)e.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return t}function s(t,e,n){for(var i=[],o=0;o<t.length;o++)i.push(c(t[o],e,n).source);return new RegExp("(?:"+i.join("|")+")",r(n))}function u(t,e,i){return h(n(t,i),e,i)}function h(t,e,n){for(var o=(n=n||{}).strict,a=!1!==n.end,s=i(n.delimiter||l),u=n.delimiters||p,h=[].concat(n.endsWith||[]).map(i).concat("$").join("|"),c="",f=!1,d=0;d<t.length;d++){var m=t[d];if("string"==typeof m)c+=i(m),f=d===t.length-1&&u.indexOf(m[m.length-1])>-1;else{var g=i(m.prefix),v=m.repeat?"(?:"+m.pattern+")(?:"+g+"(?:"+m.pattern+"))*":m.pattern;e&&e.push(m),m.optional?m.partial?c+=g+"("+v+")?":c+="(?:"+g+"("+v+"))?":c+=g+"("+v+")"}}return a?(o||(c+="(?:"+s+")?"),c+="$"===h?"$":"(?="+h+")"):(o||(c+="(?:"+s+"(?="+h+"))?"),f||(c+="(?="+s+"|"+h+")")),new RegExp("^"+c,r(n))}function c(t,e,n){return t instanceof RegExp?a(t,e):Array.isArray(t)?s(t,e,n):u(t,e,n)}var l="/",p="./",f=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");class d{constructor(t,e){this.path=t,this.callback=e,this._keys=[],this._options={},this.regex=c(this.path,this._keys,this._options)}matches(t){return!!this.regex.exec(decodeURIComponent(t))}parsePath(t){let e=this.regex.exec(decodeURIComponent(t));if(!e)return console.log("[Route] 404 - No route matched path: ",pathname),!1;let n={};for(let t=0;t<this._keys.length;t++){let i=this._keys[t],o=e[t+1];o&&(n[i.name]=decodeURIComponent(o),i.repeat&&(n[i.name]=n[i.name].split(i.delimiter)))}return n}}class m{constructor(){this._routeMap=new Map,this._onClick=this._onClick.bind(this),this._onPopState=this._onPopState.bind(this)}_addEventListeners(){document.addEventListener("click",this._onClick),window.addEventListener("popstate",this._onPopState)}_removeEventListeners(){document.removeEventListener("click",this._onClick),window.removeEventListener("popstate",this._onPopState)}_onPopState(t){let e=location;this._handleRoute(e.pathname)}_onClick(n){let i,o=n.target;if(n.composedPath){let t=n.composedPath();for(let e=0,n=t.length;e<n;e++){let n=t[e];if("A"===n.tagName){i=n;break}}}else for(;o;){if("A"===o.tagName){i=o;break}o=o.parentNode}if(i){let o=location.origin,r=location.hostname,a=i.getAttribute("href"),s=new URL(a,o);t(s,r)||e(s)||i.hasAttribute("target")||i.hasAttribute("download")||(n.preventDefault(),this._handleRequest(s))}}_handleRequest(t){let e=t.pathname;this._handleRoute(e),this._setPushState(e)}_handleRoute(t){let e=this._getRoute(t);if(!e)return void console.log("[Router] 404 - No route matched path: ",t);let n={};n.url=window.location,n.params=e.parsePath(t),e.callback.call({},n)}_setPushState(t){let e={};history.pushState(e,"",t)}_getRoute(t){let e;for(let[n,i]of this._routeMap){if((e=i).matches(t)){console.log("[Router] Route matched path: ",t);break}e=null}return e}enable(){this._addEventListeners();let t=location;this._handleRoute(t.pathname)}disable(){this._removeEventListeners()}route(t,e){let n=new d(t,e);this._routeMap.set(n.regex,n)}}return m});
//# sourceMappingURL=router.bundle.js.map
