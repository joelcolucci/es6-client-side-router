!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Router=t()}(this,function(){"use strict";function e(e,t){return-1===e.href.indexOf(t)}function t(e){return e.origin.indexOf("mailto")>-1}function n(e,t){for(var n,r=[],a=0,s=0,u="",c=t&&t.delimiter||l,h=t&&t.delimiters||p,d=!1;null!==(n=f.exec(e));){var m=n[0],g=n[1],_=n.index;if(u+=e.slice(s,_),s=_+m.length,g)u+=g[1],d=!0;else{var v="",x=e[s],R=n[2],k=n[3],w=n[4],b=n[5];if(!d&&u.length){var y=u.length-1;h.indexOf(u[y])>-1&&(v=u[y],u=u.slice(0,y))}u&&(r.push(u),u="",d=!1);var E=""!==v&&void 0!==x&&x!==v,P="+"===b||"*"===b,C="?"===b||"*"===b,L=v||c,$=k||w;r.push({name:R||a++,prefix:v,delimiter:L,optional:C,repeat:P,partial:E,pattern:$?o($):"[^"+i(L)+"]+?"})}}return(u||s<e.length)&&r.push(u+e.substr(s)),r}function i(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function o(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function r(e){return e&&e.sensitive?"":"i"}function a(e,t){if(!t)return e;var n=e.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)t.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e}function s(e,t,n){for(var i=[],o=0;o<e.length;o++)i.push(h(e[o],t,n).source);return new RegExp("(?:"+i.join("|")+")",r(n))}function u(e,t,i){return c(n(e,i),t,i)}function c(e,t,n){for(var o=(n=n||{}).strict,a=!1!==n.end,s=i(n.delimiter||l),u=n.delimiters||p,c=[].concat(n.endsWith||[]).map(i).concat("$").join("|"),h="",f=!1,d=0;d<e.length;d++){var m=e[d];if("string"==typeof m)h+=i(m),f=d===e.length-1&&u.indexOf(m[m.length-1])>-1;else{var g=i(m.prefix),_=m.repeat?"(?:"+m.pattern+")(?:"+g+"(?:"+m.pattern+"))*":m.pattern;t&&t.push(m),m.optional?m.partial?h+=g+"("+_+")?":h+="(?:"+g+"("+_+"))?":h+=g+"("+_+")"}}return a?(o||(h+="(?:"+s+")?"),h+="$"===c?"$":"(?="+c+")"):(o||(h+="(?:"+s+"(?="+c+"))?"),f||(h+="(?="+s+"|"+c+")")),new RegExp("^"+h,r(n))}function h(e,t,n){return e instanceof RegExp?a(e,t):Array.isArray(e)?s(e,t,n):u(e,t,n)}var l="/",p="./",f=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");class d{constructor(e,t){this.path=e,this.callback=t,this._keys=[],this._options={},this.regex=h(this.path,this._keys,this._options)}matches(e){return!!this.regex.exec(decodeURIComponent(e))}parsePath(e){let t=this.regex.exec(decodeURIComponent(e));if(!t)return console.log("[Route] 404 - No route matched path: ",pathname),!1;let n={};for(let e=0;e<this._keys.length;e++){let i=this._keys[e],o=t[e+1];o&&(n[i.name]=decodeURIComponent(o),i.repeat&&(n[i.name]=n[i.name].split(i.delimiter)))}return n}}class m{constructor(){this._routeMap=new Map,this._onClick=this._onClick.bind(this),this._onPopState=this._onPopState.bind(this)}_addEventListeners(){document.addEventListener("click",this._onClick),window.addEventListener("popstate",this._onPopState)}_removeEventListeners(){document.removeEventListener("click",this._onClick),window.removeEventListener("popstate",this._onPopState)}_onPopState(e){let t=location;this._handleRoute(t.pathname)}_onClick(n){let i=n.target;if(n.composedPath){let e=n.composedPath();for(let t=0,n=e.length;t<n;t++){let n=e[t];if("A"===n.tagName){i=n;break}i=null}}else for(;!i||!i.matches("a");){let e=i.parentNode;if("#document"===e.nodeName){i=null;break}i=e}if(i){let o=i.getAttribute("href"),r=location.origin,a=location.hostname,s=new URL(o,r);e(s,a)||t(s)||"_blank"!==i.getAttribute("target")&&(i.hasAttribute("download")||(n.preventDefault(),this._handleRequest(s)))}}_handleRequest(e){let t=e.pathname;this._handleRoute(t),this._setPushState(t)}_handleRoute(e){let t=this._getRoute(e);if(!t)return void console.log("[Router] 404 - No route matched path: ",e);let n={};n.url=window.location,n.params=t.parsePath(e),t.callback.call({},n)}_setPushState(e){let t={};history.pushState(t,"",e)}_getRoute(e){let t;for(let[n,i]of this._routeMap){if((t=i).matches(e)){console.log("[Router] Route matched path: ",e);break}t=null}return t}enable(){this._addEventListeners();let e=location;this._handleRoute(e.pathname)}disable(){this._removeEventListeners()}route(e,t){let n=new d(e,t);this._routeMap.set(n.regex,n)}}return m});
//# sourceMappingURL=router.bundle.js.map
